{
    "device_type": "WB-MAI2",

    "device": {
        "name": "WB-MAI2",
        "id": "wb-mai2",
        "max_read_registers": 60,
        "response_timeout_ms": 1,
        "frame_timeout_ms": 8,
        "channels": [
            // Делаем ещё один тип канала "subdevice"
            {
                "name": "IN1_P",
                "type": "subdevice",
                "address": 1,                    // Из него будет высчитываться смещение для регистров
                "oneOf": ["WB_MAI3", "WB_MAI4"]  // Список возможных типов устройств. По умолчанию, используем первое устройство в списке
                // Такой вариант разрешён только в шаблоне
            },
            {
                "name": "IN1_P2",
                "type": "subdevice",
                "address": 1,                    // Из него будет высчитываться смещение для регистров
                "device": {
                    // Обычное описание устройства, тут может быть тип из "definitions"
                    // "oneOf" нет, значит и не будет выбора в интерфейсе настроек
                }
                // Так можно писать прямо в конфиге
            },
            {
                "name": "IN1_P3",
                "type": "subdevice",
                "address": 1,                     // Из него будет высчитываться смещение для регистров
                "oneOf": ["WB_MAI3", "WB_MAI4"],  // Список возможных типов устройств. 
                "device": {
                    // Обычное описание устройства, тут может быть тип из "definitions"
                    // У нас есть "oneOf", проверяем в списке ли это устройство и используем настройки указанные тут
                }
                // Такой вариант разрешён только в шаблоне
            }
        ],
        "setup_schema": {
            // Схема редактирования настроек для JSON-editor.
            // У конкретных свойств надо добавить поле "register" с именем регистра из setup, чтобы знать куда писать

            // ...
            // "properties": {
            //     "sensor_type": {
            //         "type": "integer",
            //         "enum": [ 0 ],
            //         "default": 0,
            //         "options": {
            //             "hidden": true
            //         },
            //         "register": "IN1 type"
            //     },
            //  ...

            // Если нет setup_schema, то генерируем интерфейс настроек из элементов списка setup, где нет value
        },
        "setup": [
            // Регистры, которые надо писать
            // Можно не указывать value, тогда писаться не будет, но будет формат регистра
        ]
    },

    "definitions": [
        {
            "device_type": "WB-MAI2",
            "device": {
                "name": "",
                "id": "",
                "channels": [
                    {
                        "name": "IN1_IN1P raw",
                        "reg_type": "input",
                        "address": "0x1500",
                        "type": "value",
                        "format": "s32"
                    },
                    {
                        "name": "IN1_P",
                        "type": "subdevice",
                        "address": 1,
                        "oneOf": ["WB_MAI3", "WB_MAI4"]
                    }
                ]
            }
        }
    ]

}
